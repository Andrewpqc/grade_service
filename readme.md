# grade_service

> 华师匣子成绩查询服务

## 环境配置(container.env)

## 部署

**单独部署**:

```shell
$ docker-compose stop && docker-compose build && dockder-compose up -d &&
docker-compose ps
```

## Log

+ 2017年4月29日: 拖了2个月了...ㄟ( ▔, ▔ )ㄏ


## 关于缓存
### 基本数据
下面的数据以2017-2018学年为例：
|    学期    | xnm | xqm |        大致时间分布　| 预计公布成绩日期 |
| --------- | --- | --- | ------------------ | ---------------- |
| 第一学期 | 2017  | 3   | 2017.9.1-2018.1.29 |2017.11.1-2018.3.1 |
| 第二学期 | 2017  | 12  | 2018.3.1-2018.6.30 |2018.5.1-2018.9.1 |
| 第三学期 | 2017  | 16  | 2018.7.1-2018.7.13 |2018.7.1-2018.9.1 |

### 查询当前学年的成绩
由于学校网站出成绩时不是一次性给出成绩，所以考虑了成绩更新的问题。用户每次请求都去学校网站爬取数据，然后将爬取的数据与缓存中的数据相比较，判断学校网站数据是否更新，如更新则同时更新缓存。如果未能成功从学校网站爬来数据，则返回已经存在缓存中的数据。


### 查询以往当前学年的成绩
用户第一次查询的时候，去学校网站上爬取成绩信息，然后将结果缓存到redis中，之后的查询直接从redis中取数据即可。(以往学年的成绩已经固定，不用考虑更新问题)